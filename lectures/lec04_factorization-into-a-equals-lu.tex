%
\documentclass[../main.tex]{subfiles}

\begin{document}

\onlyinsubfile{\begin{multicols*}{4}}

\section{Factorization into A equals LU}

\sectionboxnew{
\subsection{Rules of inverses and transposes}
Transpose of a matrix $A$, generally denoted as $A^{T}$, is a matrix obtained by exchanging the rows and columns of matrix $A$. So, a matrix element at $(i, j)$ position in $A$ gets moved to $(j, i)$ position in $A^{T}$. \\

The following are the rules for finding inverses and transposes for a product of matrices: 
\begin{enumerate}
\item Inverse of a product of matrices is equal to the product of the inverses in the reverse order, i.e., 
\[(AB)^{-1} = B^{-1}A^{-1}\]
\item Similarly, transpose of a product of matrices is equal to the product of the transposes in the reverse order, i.e., 
\[(AB)^{T} = B^{T}A^{T}\]
\end{enumerate}
Recall the definition of an inverse: $AA^{-1} = I$, and take the transpose on both sides:
\[
(AA^{-1})^{T} = I^{T} = I
\]
Also, from the rule for the transpose of a product of matrices, $(AA^{-1})^{T}$ can be expressed as:
\[
(AA^{-1})^{T} = (A^{-1})^{T}A^{T}
\]
Comparing the two different expressions for $(AA^{-1})^T$, we get the following:
\[
 (A^{-1})^{T}A^{T} = I \implies \text{$(A^{-1})^{T}$ is the inverse of $A^{T}$}
\] 
\\
So, if we know the inverse of $A$, we can take its transpose to get the inverse of $A^{T}$.
}

\sectionboxnew{
\subsection{A equals LU factorization for 2-by-2 equations}
Recall that the  goal of Gaussian elimination is to transform the coefficient matrix $A$ into an upper-triangular matrix $U$ by pre-multiplying a series of elimination matrices. \\

Let's consider the following $2 \times 2$ coefficient matrix and its elimination matrix:
\[
A
=
\begin{bmatrix*}[r]
2 & 1 \\
8 & 7
\end{bmatrix*};
E_{21}
=
\begin{bmatrix*}[r]
1 & 0 \\
-4 & 1
\end{bmatrix*}
\]
Now, let's multiply $A$ and $E_{21}$ matrices to get the upper-triangular matrix $U$:
\[
\begin{bmatrix*}[r]
1 & 0 \\
-4 & 1
\end{bmatrix*}
\begin{bmatrix*}[r]
2 & 1 \\
8 & 7
\end{bmatrix*}
=
\begin{bmatrix*}
2 & 1 \\
0 & 3
\end{bmatrix*}
\]
Subsequently, multiply both sides by $E_{21}^{-1}$ to get the $A = LU$ factorization:
\[
\begin{bmatrix*}[r]
1 & 0 \\
-4 & 1
\end{bmatrix*}^{-1}
\begin{bmatrix*}[r]
1 & 0 \\
-4 & 1
\end{bmatrix*}
\begin{bmatrix*}[r]
2 & 1 \\
8 & 7
\end{bmatrix*}
=
\begin{bmatrix*}[r]
1 & 0 \\
-4 & 1
\end{bmatrix*}^{-1}
\begin{bmatrix*}[r]
2 & 1 \\
0 & 3
\end{bmatrix*}
\]
The multiplication $E_{21}$ and $E_{21}^{-1}$results in an identity matrix ($I$) and the subsequent multiplication of $I$ with $A$ leaves $A$ unchanged and results in the following equation:
\[
\begin{aligned}
\underbracket[0pt][0pt]{
\begin{bmatrix*}[r]
2 & 1 \\
8 & 7
\end{bmatrix*}
}_{\mathstrut A}
&=
\underbracket[0pt][0pt]{
\begin{bmatrix*}[r]
1 & 0 \\
4 & 1
\end{bmatrix*}
}_{\mathstrut L}
\underbracket[0pt][0pt]{
\begin{bmatrix*}[r]
2 & 1 \\
0 & 3
\end{bmatrix*}
}_{\mathstrut U}
\text{or} \\
&
=
\underbracket[0pt][0pt]{
\begin{bmatrix*}[r]
1 & 0 \\
4 & 1
\end{bmatrix*}
}_{\mathstrut L}
\underbracket[0pt][0pt]{
\begin{bmatrix*}[r]
2 & 0 \\ 
0 & 3
\end{bmatrix*}
}_{\mathstrut D}
\underbracket[0pt][0pt]{
\begin{bmatrix*}[r]
1 & \frac{1}{2} \\
0 & 1
\end{bmatrix*}
}_{\mathstrut U}
\end{aligned}
\]
}

\sectionboxnew{
\subsection{A equals LU factorization for 3-by-3 equations}
Let's consider the $3 \times 3$ coefficient matrix $A$ and its elimination matrices:
\[
\begin{gathered}
A
=
\begin{bmatrix*}[r]
1 & 0 & 1 \\
0 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix*};
E_{21}
=
\begin{bmatrix*}[r]
1 & 0 & 0 \\
-2 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix*};
E_{31}
=
\begin{bmatrix*}[r]
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix*} \\
E_{32}
=
\begin{bmatrix*}[r]
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & -5 & 
\end{bmatrix*}
\text{\makecell[tl]{\textbf{Note:} $E_{31}$ is an identity matrix and \\ will be omitted from here on}}
\end{gathered}
\]
The multiplication of the elimination matrices, $E_{32}$, $E_{31}$ and $E_{21}$, gives an overall elimination matrix $E$ that sits on the left of $A$:
\[
\underbrace{E_{32}E_{31}E_{21}}_{E}A = U \text{ (no row exchanges)}
\]
\[
\underbracket[0pt][0pt]{
\begin{bmatrix*}[r]
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & -5 & 1
\end{bmatrix*}
}_{\mathstrut E_{32}}
\underbracket[0pt][0pt]{
\begin{bmatrix*}[r]
1 & 0 & 0 \\
-2 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix*}
}_{\mathstrut E_{21}}
=
\underbracket[0pt][0pt]{
\begin{bmatrix*}[r]
1 & 0 & 0 \\
-2 & 1 & 0 \\
10 & -5 & 1
\end{bmatrix*}
}_{\mathstrut E}
\]
The lower-triangular matrix $L$ that sits on the left of  upper-triangular matrix $U$ is obtained as follows:
\[
\begin{aligned}
A &= (E_{32}E_{31}E_{21})^{-1}U \\
  &= \underbrace{E_{21}^{-1}E_{31}^{-1}E_{32}^{-1}}_{L}U
\end{aligned}
\]
\[
\underbracket[0pt][0pt]{
\begin{bmatrix*}[r]
1 & 0 & 0 \\
2 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix*}
}_{\mathstrut E_{21}^{-1}}
\underbracket[0pt][0pt]{
\begin{bmatrix*}[r]
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 5 & 1
\end{bmatrix*}
}_{\mathstrut E_{32}^{-1}}
=
\underbracket[0pt][0pt]{
\begin{bmatrix*}
1 & 0 & 0 \\
2 & 1 & 0 \\
0 & 5 & 1
\end{bmatrix*}
}_{\mathstrut L}
\]
Notice that when no row exchanges are performed, multipliers go directly into $L$.
}

\sectionboxnew{
\subsection{Permutation matrices}
Recall that permutation matrices are square matrices that are obtained by exchanging rows of an identity matrix. These matrices are typically used in Gaussian elimination to perform row exchanges when there is a zero at the pivot position and a non-zero element below it. \\

For a $3 \times 3$ identity matrix, the following $6(3!)$ permutation matrices can be obtained by exchanging its rows:
\[
\begin{gathered}
P_{12}
=
\begin{bmatrix}
0 & 1 & 0 \\
1 & 0 & 0 \\
0 & 0 & 1
\end{bmatrix};
P_{13}
=
\begin{bmatrix}
0 & 0 & 1 \\
0 & 1 & 0 \\
1 & 0 & 0 
\end{bmatrix};
P_{23}
=
\begin{bmatrix}
1 & 0 & 0 \\
0 & 0 & 1 \\
0 & 1 & 0 
\end{bmatrix}; \\
P_{231}
=
\begin{bmatrix}
0 & 1 & 0 \\
0 & 0 & 1 \\
1 & 0 & 0 
\end{bmatrix};
P_{312}
=
\begin{bmatrix}
0 & 0 & 1 \\
1 & 0 & 0 \\
0 & 1 & 0 
\end{bmatrix};
I
=
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1 
\end{bmatrix}
\end{gathered}
\]
The notation used for denoting permutation matrices has the following meaning:
\begin{itemize}
\item $P_{12}$ denotes a permutation matrix that when pre-multiplied to a matrix $A$ will exchange its rows 1 and 2
\item $P_{231}$ denotes a permutation matrix that when pre-multiplied to a matrix $A$ will rearrange its rows in the following manner: row 2 becomes row 1, row 3 becomes row 2, and row 1 becomes row 3
\item $I$ denotes the identity matrix, a special type of permutation matrix that does nothing
\end{itemize}
Permutation matrices also have the following two important properties:
\begin{enumerate}[label = Property \arabic*., itemindent = *]
\item Inverses are the transposes for permutation matrices, i.e., $P^{T} = P^{-1}$. In other words, to find the inverse of a permutation matrix, just take its transpose.
\item Multiplying any two permutation matrices in the group results in another permutation matrix that belongs to the same group.
\end{enumerate}
Similar to exchanging rows, columns of a matrix $A$ can also be exchanged by exchanging the corresponding columns of the identity matrix and post-multiplying it to $A$. 
\[
\begin{bmatrix}
a & b \\
c & d 
\end{bmatrix}
\begin{bmatrix}
0 & 1 \\
1 & 0
\end{bmatrix}
=
\begin{bmatrix}
b & a \\
d & c
\end{bmatrix}
\]
}

\onlyinsubfile{\end{multicols*}}

\end{document}
